This is bad bad nightmare.
I will not even finish compiler and cpusim for this shit.